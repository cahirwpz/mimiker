include <sys/context.h>
include <sys/thread.h>
include <sys/pcpu.h>
include <sys/proc.h>
include <mips/context.h>

define TDF_NEEDSWITCH TDF_NEEDSWITCH
define TDF_NEEDSIGCHK TDF_NEEDSIGCHK
define TDF_NEEDLOCK TDF_NEEDLOCK

define TD_PROC offsetof(thread_t, td_proc)
define TD_UCTX offsetof(thread_t, td_uctx)
define TD_KFRAME offsetof(thread_t, td_kframe)
define TD_KCTX offsetof(thread_t, td_kctx)
define TD_KSTACK offsetof(thread_t, td_kstack)
define TD_FLAGS offsetof(thread_t, td_flags)
define TD_ONFAULT offsetof(thread_t, td_onfault)
define TD_IDNEST offsetof(thread_t, td_idnest)
define TD_SPIN offsetof(thread_t, td_spin)

define STK_BASE offsetof(kstack_t, stk_base)
define STK_SIZE offsetof(kstack_t, stk_size)

define EXC_AT offsetof(ctx_t, at)
define EXC_V0 offsetof(ctx_t, v0)
define EXC_V1 offsetof(ctx_t, v1)
define EXC_A0 offsetof(ctx_t, a0)
define EXC_A1 offsetof(ctx_t, a1)
define EXC_A2 offsetof(ctx_t, a2)
define EXC_A3 offsetof(ctx_t, a3)
define EXC_T0 offsetof(ctx_t, t0)
define EXC_T1 offsetof(ctx_t, t1)
define EXC_T2 offsetof(ctx_t, t2)
define EXC_T3 offsetof(ctx_t, t3)
define EXC_T4 offsetof(ctx_t, t4)
define EXC_T5 offsetof(ctx_t, t5)
define EXC_T6 offsetof(ctx_t, t6)
define EXC_T7 offsetof(ctx_t, t7)
define EXC_S0 offsetof(ctx_t, s0)
define EXC_S1 offsetof(ctx_t, s1)
define EXC_S2 offsetof(ctx_t, s2)
define EXC_S3 offsetof(ctx_t, s3)
define EXC_S4 offsetof(ctx_t, s4)
define EXC_S5 offsetof(ctx_t, s5)
define EXC_S6 offsetof(ctx_t, s6)
define EXC_S7 offsetof(ctx_t, s7)
define EXC_T8 offsetof(ctx_t, t8)
define EXC_T9 offsetof(ctx_t, t9)
define EXC_GP offsetof(ctx_t, gp)
define EXC_SP offsetof(ctx_t, sp)
define EXC_FP offsetof(ctx_t, fp)
define EXC_RA offsetof(ctx_t, ra)
define EXC_LO offsetof(ctx_t, lo)
define EXC_HI offsetof(ctx_t, hi)
define EXC_PC offsetof(ctx_t, pc)
define EXC_SR offsetof(ctx_t, sr)
define EXC_BADVADDR offsetof(ctx_t, badvaddr)
define EXC_CAUSE offsetof(ctx_t, cause)

define EXC_FPU_F0 offsetof(user_ctx_t, f0)
define EXC_FPU_F1 offsetof(user_ctx_t, f1)
define EXC_FPU_F2 offsetof(user_ctx_t, f2)
define EXC_FPU_F3 offsetof(user_ctx_t, f3)
define EXC_FPU_F4 offsetof(user_ctx_t, f4)
define EXC_FPU_F5 offsetof(user_ctx_t, f5)
define EXC_FPU_F6 offsetof(user_ctx_t, f6)
define EXC_FPU_F7 offsetof(user_ctx_t, f7)
define EXC_FPU_F8 offsetof(user_ctx_t, f8)
define EXC_FPU_F9 offsetof(user_ctx_t, f9)
define EXC_FPU_F10 offsetof(user_ctx_t, f10)
define EXC_FPU_F11 offsetof(user_ctx_t, f11)
define EXC_FPU_F12 offsetof(user_ctx_t, f12)
define EXC_FPU_F13 offsetof(user_ctx_t, f13)
define EXC_FPU_F14 offsetof(user_ctx_t, f14)
define EXC_FPU_F15 offsetof(user_ctx_t, f15)
define EXC_FPU_F16 offsetof(user_ctx_t, f16)
define EXC_FPU_F17 offsetof(user_ctx_t, f17)
define EXC_FPU_F18 offsetof(user_ctx_t, f18)
define EXC_FPU_F19 offsetof(user_ctx_t, f19)
define EXC_FPU_F20 offsetof(user_ctx_t, f20)
define EXC_FPU_F21 offsetof(user_ctx_t, f21)
define EXC_FPU_F22 offsetof(user_ctx_t, f22)
define EXC_FPU_F23 offsetof(user_ctx_t, f23)
define EXC_FPU_F24 offsetof(user_ctx_t, f24)
define EXC_FPU_F25 offsetof(user_ctx_t, f25)
define EXC_FPU_F26 offsetof(user_ctx_t, f26)
define EXC_FPU_F27 offsetof(user_ctx_t, f27)
define EXC_FPU_F28 offsetof(user_ctx_t, f28)
define EXC_FPU_F29 offsetof(user_ctx_t, f29)
define EXC_FPU_F30 offsetof(user_ctx_t, f30)
define EXC_FPU_F31 offsetof(user_ctx_t, f31)
define EXC_FPU_FSR offsetof(user_ctx_t, fsr)

define CTX_SIZE sizeof(ctx_t)
define USER_CTX_SIZE sizeof(user_ctx_t)

define P_USPACE offsetof(proc_t, p_uspace)

# PC/EPC and SR/STATUS definitions are duplicated for convenience reasons
define PCPU_SP offsetof(pcpu_t, sp)
define PCPU_PC offsetof(pcpu_t, epc)
define PCPU_EPC offsetof(pcpu_t, epc)
define PCPU_KSP offsetof(pcpu_t, ksp)
define PCPU_CAUSE offsetof(pcpu_t, cause)
define PCPU_SR offsetof(pcpu_t, status)
define PCPU_STATUS offsetof(pcpu_t, status)
define PCPU_BADVADDR offsetof(pcpu_t, badvaddr)
define PCPU_CURTHREAD offsetof(pcpu_t, curthread)
